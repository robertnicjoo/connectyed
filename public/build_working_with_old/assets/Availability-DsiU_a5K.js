import{_ as v,x as b,e as d,f as e,j as x,F as f,z as y,t as c,o as n,k as _,v as m,A as g,q as A,s as w}from"./app-D0Fdxhbm.js";const k={name:"Availability",data(){return{processing:!1,selectedAvailabilities:[{start_date:"",end_date:"",start_time:"",end_time:"",is_all_day:!1}],listAvailabilities:[]}},computed:{user(){return this.$store.state.auth.user},authorization(){return this.$store.state.auth.authorization}},mounted(){this.fetchAvailabilities(),console.log("User:",this.user),console.log("Authorization:",this.authorization)},methods:{addNewAvailability(){this.selectedAvailabilities.push({start_date:"",end_date:"",start_time:"",end_time:"",is_all_day:!1})},removeAvailabilitySlot(a){this.selectedAvailabilities.splice(a,1)},async removeAvailability(a){if(confirm("Are you sure you want to remove this availability?"))try{await b.delete(`/api/availabilities/${a}`,{headers:{Authorization:`Bearer ${this.authorization.token}`}}),alert("Availability removed successfully."),this.fetchAvailabilities()}catch(t){console.error("Error removing availability:",t),t.response&&t.response.status===403?alert("You are not authorized to remove this availability."):t.response&&t.response.status===404?alert("Availability not found."):alert("Failed to remove availability. Please try again.")}},async submitAvailability(){this.processing=!0;let a=[];if(this.selectedAvailabilities.forEach(t=>{t.start_date&&t.end_date&&a.push({start_date:t.start_date,end_date:t.end_date,is_all_day:t.is_all_day,start_time:t.is_all_day?null:t.start_time,end_time:t.is_all_day?null:t.end_time})}),console.log("Submitting availabilities:",a),a.length===0){alert("Please add at least one availability slot with valid dates."),this.processing=!1;return}try{const t=await b.post("/api/availabilities",{availabilities:a},{headers:{Authorization:`Bearer ${this.authorization.token}`}});console.log("Response from server:",t),t.data.success?(alert("Availability saved successfully!"),this.selectedAvailabilities=[{start_date:"",end_date:"",start_time:"",end_time:"",is_all_day:!1}],this.fetchAvailabilities()):(console.error("Failed to save availability:",t.data.message),alert(t.data.message||"Failed to save availability."))}catch(t){if(console.error("Error submitting availability:",t),t.response)if(console.error("Response data:",t.response.data),t.response.status===422){const u=Object.values(t.response.data.errors).flat();alert(`Validation Error:
`+u.join(`
`))}else t.response.status===403?alert("You are not authorized to perform this action."):alert("Failed to save availability. Please try again.");else t.request?(console.error("No response received:",t.request),alert("No response from server. Please check your network connection.")):(console.error("Error setting up request:",t.message),alert("An unexpected error occurred."))}finally{this.processing=!1,console.log("Processing completed.")}},formatDate(a){return new Date(a).toLocaleDateString()},formatTime(a){if(!a)return"All Day";const[t,u,p]=a.split(":"),r=new Date;return r.setHours(parseInt(t),parseInt(u),parseInt(p)),r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},async fetchAvailabilities(){try{const a=await b.get(`/api/availabilities/${this.user.id}`,{headers:{Authorization:`Bearer ${this.authorization.token}`}});a.data.success?(this.listAvailabilities=a.data.data,console.log("Availabilities:",this.listAvailabilities)):(console.error("Failed to fetch availabilities:",a.data.message),alert("Failed to fetch availabilities. Please try again later."))}catch(a){console.error("Error fetching availabilities:",a),a.response&&a.response.status===403?alert("You are not authorized to view availabilities."):alert("An error occurred while fetching availabilities.")}}}},l=a=>(A("data-v-07962e14"),a=a(),w(),a),D={class:"max-w-7xl mx-auto p-6 bg-white rounded-sm shadow-xs"},S=l(()=>e("h2",{class:"text-xl font-bold mb-4"},"Manage Your Availability",-1)),z={class:"flex flex-wrap -mx-2"},V={class:"w-full sm:w-1/2 px-2 mb-2 sm:mb-0"},U=l(()=>e("label",{class:"block text-gray-700 font-bold mb-2"},"Start Date:",-1)),q=["onUpdate:modelValue"],E={class:"w-full sm:w-1/2 px-2 mb-2 sm:mb-0"},F=l(()=>e("label",{class:"block text-gray-700 font-bold mb-2"},"End Date:",-1)),T=["onUpdate:modelValue","min"],I={class:"flex flex-wrap -mx-2 mt-4"},N={class:"w-full sm:w-1/2 px-2 mb-2 sm:mb-0"},B=l(()=>e("label",{class:"block text-gray-700 font-bold mb-2"},"Start Time:",-1)),C=["onUpdate:modelValue","disabled","required"],P={class:"w-full sm:w-1/2 px-2 mb-2 sm:mb-0"},Y=l(()=>e("label",{class:"block text-gray-700 font-bold mb-2"},"End Time:",-1)),M=["onUpdate:modelValue","disabled","required","min"],R={class:"flex items-center mt-4"},j=["onUpdate:modelValue"],L=l(()=>e("label",{for:"is_all_day",class:"text-gray-700"},"All Day Availability",-1)),H={class:"mt-4"},O=["onClick"],G={class:"mb-4"},J={class:"mt-6 text-right"},K=["disabled"],Q={class:"max-w-7xl mx-auto p-6 bg-white rounded-sm shadow-xs mt-8"},W=l(()=>e("h2",{class:"text-xl font-bold mb-4"},"Your Availability",-1)),X={class:"min-w-full bg-white border"},Z=l(()=>e("thead",null,[e("tr",{class:"bg-gray-100 border-b"},[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Start Date"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"End Date"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Time"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),$={class:"px-4 py-2"},ee={class:"px-4 py-2"},te={class:"px-4 py-2"},se={key:0},ae={key:1},ie={class:"px-4 py-2"},oe=["onClick"],le={key:1},re=l(()=>e("td",{colspan:"4",class:"px-4 py-2 text-center text-gray-600"},"No availabilities found.",-1)),de=[re];function ne(a,t,u,p,r,o){return n(),d("div",null,[e("div",D,[S,e("form",{onSubmit:t[1]||(t[1]=x((...s)=>o.submitAvailability&&o.submitAvailability(...s),["prevent"]))},[(n(!0),d(f,null,y(r.selectedAvailabilities,(s,h)=>(n(),d("div",{key:h,class:"mb-4 p-4 border rounded-lg"},[e("div",z,[e("div",V,[U,_(e("input",{type:"date",class:"w-full border border-gray-300 rounded p-2","onUpdate:modelValue":i=>s.start_date=i,required:""},null,8,q),[[m,s.start_date]])]),e("div",E,[F,_(e("input",{type:"date",class:"w-full border border-gray-300 rounded p-2","onUpdate:modelValue":i=>s.end_date=i,required:"",min:s.start_date},null,8,T),[[m,s.end_date]])])]),e("div",I,[e("div",N,[B,_(e("input",{type:"time",class:"w-full border border-gray-300 rounded p-2","onUpdate:modelValue":i=>s.start_time=i,disabled:s.is_all_day,required:!s.is_all_day},null,8,C),[[m,s.start_time]])]),e("div",P,[Y,_(e("input",{type:"time",class:"w-full border border-gray-300 rounded p-2","onUpdate:modelValue":i=>s.end_time=i,disabled:s.is_all_day,required:!s.is_all_day,min:s.start_time},null,8,M),[[m,s.end_time]])])]),e("div",R,[_(e("input",{type:"checkbox",id:"is_all_day","onUpdate:modelValue":i=>s.is_all_day=i,class:"mr-2"},null,8,j),[[g,s.is_all_day]]),L]),e("div",H,[e("button",{type:"button",class:"bg-red-500 text-white font-bold py-1 px-3 rounded hover:bg-red-600",onClick:i=>o.removeAvailabilitySlot(h)}," Remove Availability ",8,O)])]))),128)),e("div",G,[e("button",{type:"button",class:"bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-600",onClick:t[0]||(t[0]=(...s)=>o.addNewAvailability&&o.addNewAvailability(...s))}," Add Another Availability ")]),e("div",J,[e("button",{type:"submit",class:"bg-green-500 text-white font-bold py-2 px-6 rounded hover:bg-green-600",disabled:r.processing},c(r.processing?"Saving...":"Save Availability"),9,K)])],32)]),e("div",Q,[W,e("table",X,[Z,e("tbody",null,[r.listAvailabilities.length?(n(!0),d(f,{key:0},y(r.listAvailabilities,(s,h)=>(n(),d("tr",{key:s.id,class:"border-b"},[e("td",$,c(o.formatDate(s.start_date)),1),e("td",ee,c(o.formatDate(s.end_date)),1),e("td",te,[!s.is_all_day&&s.start_time&&s.end_time?(n(),d("span",se,c(o.formatTime(s.start_time))+" to "+c(o.formatTime(s.end_time)),1)):(n(),d("span",ae," All Day "))]),e("td",ie,[e("button",{class:"bg-red-500 text-white font-bold py-1 px-3 rounded hover:bg-red-600",onClick:i=>o.removeAvailability(s.id)}," Remove ",8,oe)])]))),128)):(n(),d("tr",le,de))])])])])}const _e=v(k,[["render",ne],["__scopeId","data-v-07962e14"]]);export{_e as default};
